<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.woniu.mapper.mysql.PatientMysqlDao">
    <resultMap id="patientList" type="com.woniu.entity.dto.PatientDto">
        <id column="id" property="id"></id>
        <result column="bedid" property="bedid"></result>
        <result column="name" property="name"></result>
        <result column="sex" property="sex"></result>
        <result column="age" property="age"></result>
        <result column="area" property="area"></result>
        <result column="familyname" property="familyname"></result>
        <result column="entertime" property="entertime"></result>
    </resultMap>
    <select id="getPatientList" resultMap="patientList">
        select a.id,b.bedid,a.name,a.sex,a.age,b.area,c.familyname,b.entertime
        from patient a INNER JOIN register b INNER JOIN family c
        on a.id=b.patientid and b.familyid=c.id
    <where>
        and b.outtime is null
        <if test="name != '' and name != null">
            and a.name like concat('%',#{name},'%')
        </if>
    </where>
    </select>
    <select id="getByPatientId" resultMap="patientList">
        select a.id,b.bedid,a.name,a.sex,a.age,b.diagnose,b.area,c.familyname,b.entertime
        from patient a INNER JOIN register b INNER JOIN family c
        on a.id=b.patientid and b.familyid=c.id and a.id=#{id}
    </select>
</mapper>
